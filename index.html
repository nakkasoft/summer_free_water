<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>카카오 지도 샘플</title>
    <style>
        .customoverlay {position:relative;bottom:85px;border-radius:6px;border: 1px solid #ccc;border-bottom:2px solid #ddd;float:left;}
        .customoverlay:nth-of-type(n) {border:0; box-shadow:0px 1px 2px #888;}
        .customoverlay a {display:block;text-decoration:none;color:#000;text-align:center;border-radius:6px;font-size:14px;font-weight:bold;overflow:hidden;background: #d95050;background: #d95050 url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/arrow_white.png) no-repeat right 14px center;}
        .customoverlay .title {display:block;text-align:center;background:#fff;margin-right:35px;padding:10px 15px;font-size:14px;font-weight:bold;}
        .customoverlay:after {content:'';position:absolute;margin-left:-12px;left:50%;bottom:-12px;width:22px;height:12px;background:url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png')}

        .wrap {position: absolute;left: 0;bottom: 40px;width: 288px;height: 132px;margin-left: -144px;text-align: left;overflow: hidden;font-size: 12px;font-family: 'Malgun Gothic', dotum, '돋움', sans-serif;line-height: 1.5;}
        .wrap * {padding: 0;margin: 0;}
        .wrap .info {width: 286px;height: 120px;border-radius: 5px;border-bottom: 2px solid #ccc;border-right: 1px solid #ccc;overflow: hidden;background: #fff;}
        .wrap .info:nth-child(1) {border: 0;box-shadow: 0px 1px 2px #888;}
        .info .title {padding: 5px 0 0 10px;height: 30px;background: #eee;border-bottom: 1px solid #ddd;font-size: 18px;font-weight: bold;}
        .info .close {position: absolute;top: 10px;right: 10px;color: #888;width: 17px;height: 17px;background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/overlay_close.png');}
        .info .close:hover {cursor: pointer;}
        .info .body {position: relative;overflow: hidden;}
        .info .desc {position: relative;margin: 13px 0 0 90px;height: 75px;}
        .desc .ellipsis {overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
        .desc .jibun {font-size: 11px;color: #888;margin-top: -2px;}
        .info .img {position: absolute;top: 6px;left: 5px;width: 73px;height: 71px;border: 1px solid #ddd;color: #888;overflow: hidden;}
        .info:after {content: '';position: absolute;margin-left: -12px;left: 50%;bottom: 0;width: 22px;height: 12px;background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white.png')}
        .info .link {color: #5085BB;}
    </style>
</head>
<body>
    <div id="map" style="width:1500px;height:1400px;"></div>
    <script src="config.js"></script>
    <script>
        // 환경 변수를 로드하고 카카오 맵을 초기화하는 함수
        async function initializeMap() {
            const config = await loadConfig();
            const apiKey = config.KAKAO_API_KEY || 'YOUR_API_KEY_HERE';

            if (!apiKey) {
                console.error('API 키가 설정되지 않았습니다.');
                return;
            }else{
                console.log('API 키가 설정되었습니다.');
                console.log(apiKey);
            }
            
            // 카카오 맵 SDK를 동적으로 로드 (autoload=false 옵션 추가)
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${apiKey}&autoload=false`;
            script.onload = function() {
                // SDK 로드 완료 후 수동으로 맵 초기화
                kakao.maps.load(function() {
                    setupMap();
                });
            };
            script.onerror = function() {
                console.error('카카오 맵 SDK 로드에 실패했습니다.');
            };
            document.head.appendChild(script);
        }

        function setupMap() {
            var container = document.getElementById('map');
            if (!container) {
                console.error('지도 컨테이너를 찾을 수 없습니다.');
                return;
            }
            var options = {
                center: new kakao.maps.LatLng(37.566826, 126.9786567), // 서울 시청 좌표
                level: 3
            };

            var map = new kakao.maps.Map(container, options);

            var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png', // 마커이미지의 주소입니다    
                imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
                imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.
            // 마커의 이미지정보를 가지고 있는 마커이미지를 생성합니다
            var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imageOption);

            // 현재 열려있는 오버레이를 추적하는 변수
            var currentOverlay = null;

            // 커스텀 오버레이 닫기 함수를 전역으로 정의
            window.closeOverlay = function() {
                if (currentOverlay) {
                    currentOverlay.setMap(null);
                    currentOverlay = null;
                }
            };

            // 생수 제공 장소 데이터
            var waterStations = [
                {
                    "position": {"lat": 37.554768, "lng": 126.974568},
                    "title": "오!빙고! 공동작업장",
                    "address": "서울특별시 중구 후암로60길16-9",
                    "status": "운영중",
                    "operator": "중구청",
                    "operatingHours": "10:00-생수소진시까지",
                    "operatingPeriod": "2025년 7~8월",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.560138, "lng": 127.013993},
                    "title": "오!빙고! 청구역 쉼터",
                    "address": "서울특별시 중구 신당동 294-40",
                    "status": "운영중",
                    "operator": "중구청",
                    "operatingHours": "10:00-생수소진시까지",
                    "operatingPeriod": "2025년 7~8월",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.564094, "lng": 127.018792},
                    "title": "오!빙고! 다산어린이공원",
                    "address": "서울특별시 중구 신당동 123-1",
                    "status": "운영중",
                    "operator": "중구청",
                    "operatingHours": "10:00-생수소진시까지",
                    "operatingPeriod": "2025년 7~8월",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.568491, "lng": 127.019538},
                    "title": "오!빙고! 화학쌈지공원",
                    "address": "중구 마장로 87~89 사이",
                    "status": "운영중",
                    "operator": "중구청",
                    "operatingHours": "10:00-생수소진시까지",
                    "operatingPeriod": "2025년 7~8월",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.556885, "lng": 126.966002},
                    "title": "오!빙고! 손기정체육공원",
                    "address": "중구 손기정로 101-5",
                    "status": "운영중",
                    "operator": "중구청",
                    "operatingHours": "10:00-생수소진시까지",
                    "operatingPeriod": "2025년 7~8월",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.587528, "lng": 127.102061},
                    "title": "중랑옹달샘 용마경로복지관 뒤",
                    "address": "서울특별시 중랑구 용마산로94길 97",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.572750, "lng": 127.091149},
                    "title": "중랑옹달샘 용마폭포공원 인근",
                    "address": "서울특별시 중랑구 면목제4동 용마산로 250-12",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.580012, "lng": 127.095414},
                    "title": "중랑옹달샘 사가정공원 입구",
                    "address": "서울특별시 중랑구 면목동 산46-5",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.597925, "lng": 127.114946},
                    "title": "중랑옹달샘 망우역사문화공원 삼거리",
                    "address": "망우동 산57-1",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.607234, "lng": 127.091131},
                    "title": "중랑옹달샘 봉수대공원 입구",
                    "address": "신내동 산124",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.612777, "lng": 127.088753},
                    "title": "중랑옹달샘 옹기테마공원 입구",
                    "address": "신내동 777",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.586942, "lng": 127.073851},
                    "title": "중랑옹달샘 겸재작은도서관 인근",
                    "address": "중랑천로 6",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.600230, "lng": 127.073588},
                    "title": "중랑옹달샘 구립세화어린이집 건너편",
                    "address": "중랑천로 174",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.613551, "lng": 127.072656},
                    "title": "중랑옹달샘 수림대공원 인근",
                    "address": "묵동 385",
                    "status": "운영중",
                    "operator": "중랑구청",
                    "operatingHours": "09:00-19:00",
                    "operatingPeriod": "7/15~8/18",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.589525, "lng": 127.017147},
                    "title": "생수나눔 냉장고 성북구청 바람마당",
                    "address": "보문로 168",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.588218, "lng": 127.006657},
                    "title": "생수나눔 냉장고 분수마루",
                    "address": "분수마루",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.595166, "lng": 127.006932},
                    "title": "생수나눔 냉장고 성북근린공원 하늘한마당",
                    "address": "성북로4길 177",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.616383, "lng": 127.002323},
                    "title": "생수나눔 냉장고 정릉천 방재단 초소",
                    "address": "정릉천 방재단 초소(산장아파트 뒤)",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.619723, "lng": 127.004511},
                    "title": "생수나눔 냉장고 북한산 자락길",
                    "address": "북한산 자락길(정릉초 뒤)",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.597338, "lng": 127.025983},
                    "title": "생수나눔 냉장고 개운산공원 산책로 입구",
                    "address": "북악산로 949-60",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.609807, "lng": 127.041866},
                    "title": "생수나눔 냉장고 오동도서관 자락길 초입",
                    "address": "오동도서관 자락길 초입",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.605261, "lng": 127.053031},
                    "title": "생수나눔 냉장고 청량근린공원 입구 계단",
                    "address": "청량근린공원 입구 계단",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.618210, "lng": 127.050870},
                    "title": "생수나눔 냉장고 간대어린이 공원",
                    "address": "간대어린이 공원",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.619996, "lng": 127.053891},
                    "title": "생수나눔 냉장고 우이천 초입",
                    "address": "서울특별시 성북구 장위동 158-51",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.613602, "lng": 127.069950},
                    "title": "생수나눔 냉장고 중랑천 다목적 광장",
                    "address": "중랑천 다목적 광장",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.608569, "lng": 127.070409},
                    "title": "생수나눔 냉장고 석계초등학교 앞 장미공원",
                    "address": "서울특별시 성북구 석관동 27-1",
                    "status": "운영중",
                    "operator": "성북구청",
                    "operatingHours": "24시간",
                    "operatingPeriod": "7/15~8/15",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.679004, "lng": 127.050162},
                    "title": "봉달샘 중랑천 노원교 하부",
                    "address": "중랑천 노원교 하부",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.670755, "lng": 127.048052},
                    "title": "봉달샘 서원아파트 105동 앞",
                    "address": "서원아파트 105동 앞 (황톳길 옆)",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.661818, "lng": 127.050849},
                    "title": "봉달샘 중랑천 상계교 하부",
                    "address": "중랑천 상계교 하부",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.652833, "lng": 127.053697},
                    "title": "봉달샘 중랑천 창동교 하부",
                    "address": "중랑천 창동교 하부",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.637006, "lng": 127.036658},
                    "title": "봉달샘 우이천 우이3교 하부",
                    "address": "우이천 우이3교 하부",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.644191, "lng": 127.029122},
                    "title": "봉달샘 우이천 수유교 주변",
                    "address": "우이천 수유교 주변",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.651641, "lng": 127.041462},
                    "title": "봉달샘 초안산근린공원 입구",
                    "address": "초안산근린공원 입구 (창원초교 교차로)",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.659610, "lng": 127.029486},
                    "title": "봉달샘 발바닥공원 내부",
                    "address": "발바닥공원 내부 (꽃피는숲속마을)",
                    "status": "운영중",
                    "operator": "도봉구청",
                    "operatingHours": "08:00-19:30",
                    "operatingPeriod": "7/10~8/9",
                    "type": "생수제공"
                },
                {
                    "position": {"lat": 37.673827, "lng": 127.062519},
                    "title": "힐링 냉장고 수락산 무장애숲길",
                    "address": "수락산 무장애숲길(제1구간 첫 번째 휴게쉼터)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-18:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.668188, "lng": 127.062186},
                    "title": "힐링 냉장고 종달새 어린이공원",
                    "address": "수락산 무장애숲길 인근(종달새 어린이공원)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-18:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.622869, "lng": 127.054449},
                    "title": "힐링 냉장고 영축산 SK뷰 아파트",
                    "address": "영축산 무장애숲길(SK뷰 아파트)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.625173, "lng": 127.052024},
                    "title": "힐링 냉장고 영축산 광명교회",
                    "address": "영축산 무장애숲길(광명교회)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.625109, "lng": 127.059494},
                    "title": "힐링 냉장고 영축산 어울마루",
                    "address": "영축산 무장애숲길(영축산 어울마루)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.632684, "lng": 127.052489},
                    "title": "힐링 냉장고 초안산 청백아파트 인근",
                    "address": "초안산 무장애숲길(청백아파트 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.628478, "lng": 127.045889},
                    "title": "힐링 냉장고 우이천 신우빌라 인근",
                    "address": "우이천(신우빌라 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.624386, "lng": 127.068215},
                    "title": "힐링 냉장고 중랑천 한천교",
                    "address": "중랑천(한천교)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.655374, "lng": 127.080480},
                    "title": "힐링 냉장고 불암산 나비정원",
                    "address": "불암산 나비정원(야외 테라스)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.628393, "lng": 127.075819},
                    "title": "힐링 냉장고 경춘선힐링쉼터",
                    "address": "경춘선(경춘선힐링쉼터)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.630775, "lng": 127.064824},
                    "title": "힐링 냉장고 경춘철교 위",
                    "address": "중랑천(경춘철교 위)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.624107, "lng": 127.092707},
                    "title": "힐링 냉장고 경춘선 불빛정원",
                    "address": "경춘선 불빛정원(불빛터널 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-20:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.620795, "lng": 127.078533},
                    "title": "힐링 냉장고 공릉두산아파트 인근",
                    "address": "경춘선(공릉두산아파트 인근 인공폭포)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.652911, "lng": 127.054755},
                    "title": "힐링 냉장고 창동교 인근",
                    "address": "중랑천(창동교 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.667592, "lng": 127.049842},
                    "title": "힐링 냉장고 중랑천 육교 인근",
                    "address": "중랑천(중랑천 육교 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.645281, "lng": 127.061711},
                    "title": "힐링 냉장고 어린이교통공원 인근",
                    "address": "당현천(어린이교통공원 인근)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.649248, "lng": 127.065505},
                    "title": "힐링 냉장고 성서대 인근",
                    "address": "당현천(성서대 인근 바닥분수)",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "07:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.639727, "lng": 127.065518},
                    "title": "힐링 냉장고 중계근린공원",
                    "address": "중계근린공원",
                    "status": "운영중",
                    "operator": "노원구청",
                    "operatingHours": "08:00-22:00",
                    "operatingPeriod": "7/15~8/25",
                    "type": "냉장고"
                },
                {
                    "position": {"lat": 37.556642, "lng": 126.928356},
                    "title": "마포샘터 레드로드발전소",
                    "address": "동교동 레드로드발전소",
                    "status": "운영중",
                    "operator": "마포구청",
                    "operatingHours": "09:00-20:00 (폭염특보시)",
                    "operatingPeriod": "8/1~9/30",
                    "type": "냉장고(전화인증)"
                },
                {
                    "position": {"lat": 37.583054, "lng": 126.883716},
                    "title": "마포샘터 구룡근린공원",
                    "address": "상암동 구룡근린공원",
                    "status": "운영중",
                    "operator": "마포구청",
                    "operatingHours": "09:00-20:00 (폭염특보시)",
                    "operatingPeriod": "8/1~9/30",
                    "type": "냉장고(전화인증)"
                },
                {
                    "position": {"lat": 37.540676, "lng": 126.943493},
                    "title": "마포샘터 토정공원",
                    "address": "용강동 토정공원",
                    "status": "운영중",
                    "operator": "마포구청",
                    "operatingHours": "09:00-20:00 (폭염특보시)",
                    "operatingPeriod": "8/1~9/30",
                    "type": "냉장고(전화인증)"
                },
                {
                    "position": {"lat": 37.544969, "lng": 126.946695},
                    "title": "마포샘터 경의선숲길공원",
                    "address": "염리동 경의선숲길공원",
                    "status": "운영중",
                    "operator": "마포구청",
                    "operatingHours": "09:00-20:00 (폭염특보시)",
                    "operatingPeriod": "8/1~9/30",
                    "type": "냉장고(전화인증)"
                }
                ];

            // 생수 제공소 정보창 생성 함수
            function createWaterStationContent(station) {
                var statusClass = station.status === "운영중" ? "operating" : "closed";
                var statusIcon = station.status === "운영중" ? "✅" : "❌";
                var phoneInfo = station.phone ? station.phone : "정보없음";
                
                return '<div class="wrap">' + 
                '    <div class="info">' + 
                '        <div class="title">' + 
                '            🚰 ' + station.title + 
                '            <div class="close" onclick="closeOverlay()" title="닫기"></div>' + 
                '        </div>' + 
                '        <div class="body">' + 
                '            <div class="img">' +
                '                <div style="width:73px;height:70px;background:#f0f8ff;display:flex;align-items:center;justify-content:center;font-size:24px;">💧</div>' +
                '           </div>' + 
                '            <div class="desc">' + 
                '                <div class="ellipsis"><strong>' + station.address + '</strong></div>' + 
                '                <div class="jibun ellipsis">⏰ ' + station.operatingHours + '</div>' + 
                '                <div class="jibun ellipsis">🏢 ' + station.operator + '</div>' + 
                '                <div class="jibun ellipsis">📞 ' + phoneInfo + '</div>' + 
                '                <div class="ellipsis">' + statusIcon + ' ' + station.status + ' (' + station.type + ')</div>' + 
                '                <div class="jibun ellipsis">📅 ' + station.operatingPeriod + '</div>' + 
                '            </div>' + 
                '        </div>' + 
                '    </div>' +    
                '</div>';
            }

            // 마커를 생성하고 지도위에 표시하는 함수
            function addWaterStationMarker(station) {
                // JSON 형식의 position을 kakao.maps.LatLng 객체로 변환
                var position = new kakao.maps.LatLng(station.position.lat, station.position.lng);
                
                // 마커를 생성합니다
                var marker = new kakao.maps.Marker({
                    position: position,
                    image: markerImage // 마커이미지 설정 
                });

                // 마커가 지도 위에 표시되도록 설정합니다
                marker.setMap(map);

                // 커스텀 오버레이를 생성합니다 (초기에는 지도에 표시하지 않음)
                var customOverlay = new kakao.maps.CustomOverlay({
                    position: marker.getPosition(),
                    content: createWaterStationContent(station),
                    yAnchor: 1
                });

                // 마커를 클릭했을 때 커스텀 오버레이를 표시합니다
                kakao.maps.event.addListener(marker, 'click', function() {
                    // 이전에 열려있던 오버레이가 있다면 닫습니다
                    if (currentOverlay) {
                        currentOverlay.setMap(null);
                    }
                    
                    // 새로운 오버레이를 표시합니다
                    customOverlay.setMap(map);
                    currentOverlay = customOverlay;
                });
            }

            // 모든 생수 제공소에 마커를 추가합니다
            waterStations.forEach(function(station) {
                addWaterStationMarker(station);
            });

        }

        // 페이지 로드 시 맵 초기화
        initializeMap();
    </script>
</body>
</html>
