<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>카카오 지도 샘플</title>
</head>
<body>
    <div id="map" style="width:1500px;height:1400px;"></div>
    <script src="config.js"></script>
    <script>
        // 환경 변수를 로드하고 카카오 맵을 초기화하는 함수
        async function initializeMap() {
            const config = await loadConfig();
            const apiKey = config.KAKAO_API_KEY || 'YOUR_API_KEY_HERE';
            
            // 카카오 맵 SDK를 동적으로 로드
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = `//dapi.kakao.com/v2/maps/sdk.js?appkey=${apiKey}`;
            script.onload = function() {
                setupMap();
            };
            document.head.appendChild(script);
        }

        function setupMap() {
            var container = document.getElementById('map');
            var options = {
                center: new kakao.maps.LatLng(37.566826, 126.9786567), // 서울 시청 좌표
                level: 3
            };

            var map = new kakao.maps.Map(container, options);

            // 지도에 표시된 마커 객체를 가지고 있을 배열입니다
            var markers = [];

            // 마커 하나를 지도위에 표시합니다 
            addMarker(new kakao.maps.LatLng(33.450701, 126.570667));
            addMarker(new kakao.maps.LatLng(33.350701, 126.470667));

            // 마커를 생성하고 지도위에 표시하는 함수입니다
            function addMarker(position) {
                
                // 마커를 생성합니다
                var marker = new kakao.maps.Marker({
                    position: position
                });

                // 마커가 지도 위에 표시되도록 설정합니다
                marker.setMap(map);
                
                // 생성된 마커를 배열에 추가합니다
                markers.push(marker);
            }
            
            // 배열에 추가된 마커들을 지도에 표시하거나 삭제하는 함수입니다
            function setMarkers(map) {
                for (var i = 0; i < markers.length; i++) {
                    markers[i].setMap(map);
                }            
            }
            //setMarkers(map);
        }

        // 페이지 로드 시 맵 초기화
        initializeMap();
    </script>
</body>
</html>